{% extends "index.html" %}

{% block title %}PianoTour - Extras{% endblock %}

{% block side %}

<a href="/clarinet">
  <button class="btn btn--info btn--side playback-controls__button">
    Clarinet
  </button>
</a>
<a href="/french_horn">
  <button id="midi-player-btn" class="btn btn--info btn--side playback-controls__button">
    French Horn
  </button>
</a>
<br />
<a href="/harp">
  <button id="midi-player-btn" class="btn btn--info btn--side playback-controls__button">
    Harp
  </button>
</a>
<br />
<a href="/bass">
  <button id="midi-player-btn" class="btn btn--info btn--side playback-controls__button">
    Bass
  </button>
</a>
<br />
<a href="/player">
  <button id="midi-player-btn" class="btn btn--primary btn--side playback-controls__button">
    MIDI Player
  </button>
</a>
<a href="/practice">
  <button id="practice-btn" class="btn btn--info btn--side">
    Sight Reading Practice
  </button>
  <a href="/json">
  <button id="json-btn" class="btn btn--info btn--side">
    Edit JSON
  </button>
</a>
<br />
<button id="export-midi-btn" class="btn btn--info btn--side">Export MIDI</button>
<!-- This input is not a visible button -->
<input type="file" id="file-loader-input" style="display: none" accept=".json, .mid, .midi" />
{% endblock %}

{% block scripts %}
<script type="module">
  import { exportMidi, initializeFileHandlers } from ('{{ url_for("static", filename="js/utils/scoreRenderer.js") }}');
  // Initialize file handlers when the page loads
  document.addEventListener('DOMContentLoaded', () => {
    
    // Add event listener for the export MIDI button
    document.getElementById('export-midi-btn')?.addEventListener('click', (e) => {
      e.preventDefault();
      document.getElementById('instrument')?.focus();
      exportMidi();
    });
    
    console.log("Extras page initialized with MIDI export functionality.");
  });
</script>
{% endblock %}